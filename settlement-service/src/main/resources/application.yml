spring:
  application:
    name: settlement-service
  
  datasource:
    url: jdbc:postgresql://localhost:5432/payment_gateway
    username: payments_user
    password: ${DB_PASSWORD:payments_pass}
    driver-class-name: org.postgresql.Driver
    hikari:
      # Connection pool optimized for batch processing
      maximum-pool-size: ${DB_POOL_MAX_SIZE:30}
      minimum-idle: ${DB_POOL_MIN_IDLE:5}
      connection-timeout: ${DB_CONNECTION_TIMEOUT:10000}
      idle-timeout: ${DB_IDLE_TIMEOUT:300000}
      max-lifetime: ${DB_MAX_LIFETIME:600000}
      pool-name: SettlementServicePool
      # PostgreSQL optimizations for batch operations
      data-source-properties:
        cachePrepStmts: true
        prepStmtCacheSize: 250
        prepStmtCacheSqlLimit: 2048
        useServerPrepStmts: true
        reWriteBatchedInserts: true
  
  jpa:
    hibernate:
      ddl-auto: validate
    show-sql: false
    open-in-view: false
    properties:
      hibernate:
        dialect: org.hibernate.dialect.PostgreSQLDialect
        format_sql: false
        jdbc:
          time_zone: UTC
          batch_size: 100  # Large batch size for settlement processing
          fetch_size: 500
          batch_versioned_data: true
        order_inserts: true
        order_updates: true
  
  kafka:
    bootstrap-servers: localhost:9092
    consumer:
      group-id: settlement-service
      auto-offset-reset: earliest
      key-deserializer: org.apache.kafka.common.serialization.StringDeserializer
      value-deserializer: org.apache.kafka.common.serialization.StringDeserializer
    producer:
      key-serializer: org.apache.kafka.common.serialization.StringSerializer
      value-serializer: org.apache.kafka.common.serialization.StringSerializer

server:
  port: 8449

management:
  endpoints:
    web:
      exposure:
        include: health,info,metrics,prometheus
  metrics:
    export:
      prometheus:
        enabled: true

logging:
  level:
    com.paymentgateway.settlement: INFO
    org.springframework: WARN
    org.hibernate: WARN
